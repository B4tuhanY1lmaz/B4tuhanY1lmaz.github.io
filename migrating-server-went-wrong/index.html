<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="The Batuhan's Blog" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="The Batuhan's Blog" /> <title> Migrating server went wrong - The Batuhan's Blog </title> <link rel="alternate" href="http://thebatuhansnetwork.xyz/migrating-server-went-wrong/" hreflang="en-US" /> <link rel="canonical" href="http://thebatuhansnetwork.xyz/migrating-server-went-wrong/" /> <meta name="description" content="The Batuhan&#39;s Blog" /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Migrating server went wrong | Batuhan Yılmaz" /> <meta property="og:title" content="Migrating server went wrong | Batuhan Yılmaz" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://thebatuhansnetwork.xyz/migrating-server-went-wrong/" /> <meta property="og:description" content="The Batuhan&#39;s Blog" /> <meta property="og:image" content="http://thebatuhansnetwork.xyz/assets/img/ogp.png" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Migrating server went wrong | twitter_username" /> <meta name="twitter:url" content="http://thebatuhansnetwork.xyz/migrating-server-went-wrong/" /> <meta name="twitter:site" content="@twitter_username" /> <meta name="twitter:creator" content="@twitter_username" /> <meta name="twitter:description" content="The Batuhan&#39;s Blog" /> <meta name="twitter:image" content="http://thebatuhansnetwork.xyz/assets/img/ogp.png" /> <link type="application/atom+xml" rel="alternate" href="http://thebatuhansnetwork.xyz/feed.xml" title="The Batuhan's Blog" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">home</a><a class="menu-link" href="/archive/">archive</a><a class="menu-link" href="/about/">about</a><a class="menu-link" href="https://www.buymeacoffee.com/bthyilmaz" target="_blank" rel="noopener" >buy me a coffee!</a ><a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <h1 class="header-title" itemprop="headline">Migrating server went wrong</h1> <div class="post-meta"> <time datetime="2023-03-20T20:01:28+00:00" itemprop="datePublished"> Mar 20, 2023 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Batuhan Yılmaz</span> </span> <time hidden datetime="" itemprop="dateModified"> Mar 20, 2023 </time> <span hidden itemprop="publisher" itemtype="Person"></span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"><p>Hello everyone I’m Batuhan. 2 days ago I decided to migrate my new server’s 80 GB OS HDD into a 32 GB USB 3.0 drive and even tho migration has finished without any problems but since we aren’t livin in the perfect world. It created lots of problems and I had to reverse it and now the site you’re currently in works from that HDD. Let’s hope into details. The idea of doing this migration isn’t actually new. I had that idea since the day I got this server. Becouse Hdd of this server is an OEM Seagate Barracuda 80 GB drive from January of 2010 and at the time I got this server it had total of 38K hours of runtimes and 2 days ago this number was about to hit to the 39K. Actually drive works perfectly fine. I never encountered any problems with it. Since its most I/O tasks are done while the server boots and it just idles most of it’s uptimes. But since this drive is an 13 years old drive it just scares me. To fix that not existing problem I was thinking about doing a whole reinstall of the Debian 11 on that USB drive and start from fresh on my server which I already did 5 weeks ago lol. Than I gave up from that idea becouse reconfiguring things and most importantly the RAID 1 isn’t a thing I would like to do and for that I decided to clone the OS drive and continue from where I left before. But sonce I said earlier we aren’t living in the perfect awesome world and things always goes wrong. The migration progress went perfectly fine. To do the migration I booted up my laptop and ssh’d into server, than used dd to create an image of the HDD and after getting the image I used the gzip to compress it. I used <a href="https://wiki.archlinux.org/title/Dd">this wiki page</a> as an referance on Ach wiki to do that. Please be carefull when using DD on your own machine. After getting the image and compression progress is done. I copied the image to my Laptop using Nautilus (Yes I used a GUi program instead of scp command line. I don’t use Arch btw.) While the imaging the drive, I downloaded the Clonezilla-live and created a VM with it. After that I mounted my Ventoy USB, Clonezilla LiveCD, the USB drive I’m gonna use for the OS and the image I just got from my server into the virtual machine and booted it. Before migrating anything I had to do some changes on the image. Becouse the image was to big for my 32GB USB and that scares the clonezilla. For that I booted the Fedora 38 pre-release from the Ventoy USB and changed the partitions of the image. I removed the swap and resized the root partition to 26 GB and it went perfectly fine. After that I booted up the CloneZilla Live and cloned the image to the USB drive. Until that actually everything went perfectly fine. But the problems started when I try to boot the USB on my server.</p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <p>Hello everyone I’m Batuhan. 2 days ago I decided to migrate my new server’s 80 GB OS HDD into a 32 GB USB 3.0 drive and even tho migration has finished without any problems but since we aren’t livin in the perfect world. It created lots of problems and I had to reverse it and now the site you’re currently in works from that HDD. Let’s hope into details. The idea of doing this migration isn’t actually new. I had that idea since the day I got this server. Becouse Hdd of this server is an OEM Seagate Barracuda 80 GB drive from January of 2010 and at the time I got this server it had total of 38K hours of runtimes and 2 days ago this number was about to hit to the 39K. Actually drive works perfectly fine. I never encountered any problems with it. Since its most I/O tasks are done while the server boots and it just idles most of it’s uptimes. But since this drive is an 13 years old drive it just scares me. To fix that not existing problem I was thinking about doing a whole reinstall of the Debian 11 on that USB drive and start from fresh on my server which I already did 5 weeks ago lol. Than I gave up from that idea becouse reconfiguring things and most importantly the RAID 1 isn’t a thing I would like to do and for that I decided to clone the OS drive and continue from where I left before. But sonce I said earlier we aren’t living in the perfect awesome world and things always goes wrong. The migration progress went perfectly fine. To do the migration I booted up my laptop and ssh’d into server, than used dd to create an image of the HDD and after getting the image I used the gzip to compress it. I used <a href="https://wiki.archlinux.org/title/Dd">this wiki page</a> as an referance on Ach wiki to do that. Please be carefull when using DD on your own machine. After getting the image and compression progress is done. I copied the image to my Laptop using Nautilus (Yes I used a GUi program instead of scp command line. I don’t use Arch btw.) While the imaging the drive, I downloaded the Clonezilla-live and created a VM with it. After that I mounted my Ventoy USB, Clonezilla LiveCD, the USB drive I’m gonna use for the OS and the image I just got from my server into the virtual machine and booted it. Before migrating anything I had to do some changes on the image. Becouse the image was to big for my 32GB USB and that scares the clonezilla. For that I booted the Fedora 38 pre-release from the Ventoy USB and changed the partitions of the image. I removed the swap and resized the root partition to 26 GB and it went perfectly fine. After that I booted up the CloneZilla Live and cloned the image to the USB drive. Until that actually everything went perfectly fine. But the problems started when I try to boot the USB on my server.</p> <h3 id="problem-1"> <a href="#problem-1" class="anchor-head"></a> Problem 1: </h3> <p>So the first problem I encountered is mdadm. First thing that showed up when I booted up my server was mdadm wasn’t detecting my RAID 1 and becouse of that fstab was failing to mount the RAID volume and OS wasn’t booting. To investigate the problem on the OS side I shutdown the server and plugged that USB back to my laptop and edited the fstab and commented it out. And after that it booted just fine if we don’t mind the mdadm errors.</p> <h3 id="problem-2"> <a href="#problem-2" class="anchor-head"></a> Problem 2 </h3> <p>The second and the biggest problem was the server was slow. In any terms it was very slow. For some reason when I boot the USB on my Laptop via the USB 3.0 port it runs perfectly fine but on server it was slow as hell. And that was leading systemD to go crazy. Booting it up were takes 2 minutes and even logging on over the TtY were almost impossible. It was leading the OS to crash after waiting for 5 minutes.</p> <p>These were the 2 problem I was having and since I already had 3 days of downtime I wanted to give up on it and just keep a backup of the drive on my laptop and do a reinstall of the OS when it’s time has come. But for now it works perfectly fine and on programming world we have term. If it works, don’t fix it. And this is what I’m going to do.</p> <h2 id="thank-you"> <a href="#thank-you" class="anchor-head"></a> Thank You! </h2> <p>Batuhan Yılmaz - 21.03.2023 - 9/100</p> </div> </article> </main> <section class="webring"> <h3>Recent posts from Blogs I follow</h3> <section class="articles"> <div class="article"> <h4 class="title"> <a href="https://andy-bell.co.uk/why-pay-8-for-a-check-mark-when-you-can-get-one-for-for-free/" target="_blank" rel="noopener">Why pay $8 for a checkmark when you can get one for free?</a> </h4> <p class="summary">Elon Musk has removed check marks from everyone now on Twitter, so I thought I&#39;d make a web component so you can add one wherever you want!</p> <small class="source"> via <a href="https://andy-bell.co.uk">Andy Bell</a> </small> <small class="date">April 22, 2023</small> </div> <div class="article"> <h4 class="title"> <a href="https://kevquirk.com/moving-from-jekyll-to-blot" target="_blank" rel="noopener"> Moving from Jekyll to Blot </a> </h4> <p class="summary"> I’ve been exploring Blot lately. It’s great, so I’ve decided to move this site over to it from Jekyll. I recently wrote about whether my current setup was good enough and whether I should move over to Blot for my blogging platform. Now, I …</p> <small class="source"> via <a href="https://kevquirk.com"> Kev Quirk </a> </small> <small class="date">April 19, 2023</small> </div> <div class="article"> <h4 class="title"> <a href="https://joelchrono12.xyz/blog/march-2023-summary/" target="_blank" rel="noopener">March 2023 Summary</a> </h4> <p class="summary">I can&#39;t believe another month went by. Here&#39;s my media consumption this time around! March was a crazy month indeed.</p> <small class="source"> via <a href="https://joelchrono12.xyz/">Joelchrono12</a> </small> <small class="date">April 1, 2023</small> </div> </section> <p class="attribution"> Generated by <a href="https://git.sr.ht/~sircmpwn/openring">openring</a> </p> </section> <style> .webring .articles { display: flex; flex-wrap: wrap; margin: -0.5rem; } .webring .title { margin: 0; } .webring .article { flex: 1 1 0; display: flex; flex-direction: column; margin: 0.5rem; padding: 0.5rem; background: #131418; min-width: 10rem; } .webring .summary { font-size: 0.8rem; flex: 1 1 0; } .webring .attribution { text-align: right; font-size: 0.8rem; color: #555; } </style> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/im-on-diffblog-now/" > <div class="nav-arrow">Previous</div> <span class="post-title">I'm on diff.blog now!</span> </a> <a class="post-nav-item post-nav-next" href="/10th-post-of-100daystooffload/"> <div class="nav-arrow">Next</div> <span class="post-title">10th post of #100DaysToOffload</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="/thanks">ack.</a> <a class="footer_item" href="/feed.xml">rss</a> <span class="footer_item">&copy; 2023</span> <small class="footer_copyright"> <!-- Klisé Theme: https://github.com/piharpi/jekyll-klise --> <a href="https://github.com/piharpi/jekyll-klise" target="_blank" rel="noreferrer noopener" >klisé</a > theme on <a href="https://jekyllrb.com" target="_blank" rel="noreferrer noopener" >jekyll</a > </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> <!-- Matomo Image Tracker--> <img referrerpolicy="no-referrer-when-downgrade" src="https://a.thebatuhansnetwork.xyz/matomo.php?idsite=1&amp;rec=1" style="border:0" alt="" /> <!-- End Matomo --> </div> </body> </html>
